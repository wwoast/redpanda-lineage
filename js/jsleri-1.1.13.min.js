!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.jsleri=e():t.jsleri=e()}(self,(function(){return(()=>{"use strict";var t={d:(e,r)=>{for(var n in r)t.o(r,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:r[n]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};function r(){return(r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t}).apply(this,arguments)}function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}t.r(e),t.d(e,{Choice:()=>h,EOS:()=>T,Grammar:()=>O,Keyword:()=>d,List:()=>y,Optional:()=>m,Prio:()=>g,Ref:()=>x,Regex:()=>b,Repeat:()=>w,Sequence:()=>_,THIS:()=>E,Token:()=>J,Tokens:()=>S,noop:()=>s,version:()=>o});var o="1.1.13",s=function(){},i=/^\s+/,a=/^\w+/,c=/\s+/,p=function(t){return"function"==typeof t},l=function(t){return"string"==typeof t&&0!==t.indexOf("^",0)&&(t="^"+t),new RegExp(t)},u=function(t,e){return t.length<e.length},f=function(t,e,r,n){var o=new C,s=function(t,r,n){n>o.pos&&o.empty(),r.end=n,r.str=e.substring(r.start,r.end),t.push(r)},a=function t(r,a,c,p,l){var u,f,v,x,O,E,R,T,C;if(u=e.substring(a).replace(i,""),T=new q(r,e.length-u.length),o.setModeRequired(T.start,l),r instanceof h){for(C=new V(!1,T.start),x=0,O=r.elements.length;x<O;x++)R=[],(v=t(r.elements[x],T.start,R,p,!0)).isValid&&v.pos>C.pos&&(T.children=R,C=v);return C.isValid&&s(c,T,C.pos),C}if(r instanceof d)return E=u.match(n),(f=r.ignCase?Boolean(E&&E[0].toLowerCase()===r.keyword.toLowerCase()):Boolean(E&&E[0]===r.keyword))?s(c,T,T.start+r.keyword.length):o.update(r,T.start),new V(f,T.end||T.start);if(r instanceof y){for(a=T.start,x=0,O=0;(v=t(r.element,a,T.children,p,x<r.min)).isValid&&(a=v.pos,x++,(v=t(r.delimiter,a,T.children,p,x<r.min)).isValid);)a=v.pos,O++;return(f=!(x<r.min||r.max&&x>r.max||!r.opt&&x&&x==O))&&s(c,T,a),new V(f,a)}if(r instanceof m)return(v=t(r.element,T.start,T.children,p,!1)).isValid&&s(c,T,v.pos),new V(!0,T.end||T.start);if(r instanceof g){for(void 0===p._tested[T.start]&&(p._tested[T.start]=new V(!1,T.start)),x=0,O=r.elements.length;x<O;x++)R=[],(v=t(r.elements[x],T.start,R,p,!0)).isValid&&v.pos>p._tested[T.start].pos&&(T.children=R,p._tested[T.start]=v,p._tree[T.start]=R);return p._tested[T.start].isValid&&s(c,T,p._tested[T.start].pos),p._tested[T.start]}if(r instanceof b)return E=u.match(r._re),(f=Boolean(E))?s(c,T,T.start+E[0].length):o.update(r,T.start),new V(f,T.end||T.start);if(r instanceof w){for(a=T.start,x=0;(!r.max||x<r.max)&&(v=t(r.element,a,T.children,p,x<r.min)).isValid;x++)a=v.pos;return(f=x>=r.min)&&s(c,T,a),new V(f,a)}if(r instanceof j)return r._tested={},r._tree={},(v=t(r.element,T.start,T.children,r,!0)).isValid&&s(c,T,v.pos),v;if(r instanceof _){for(a=T.start,x=0,O=r.elements.length;x<O;x++){if(!(v=t(r.elements[x],a,T.children,p,!0)).isValid)return v;a=v.pos}return s(c,T,v.pos),v}if(r instanceof J)return(f=Boolean(0===u.indexOf(r.token)))?s(c,T,T.start+r.token.length):o.update(r,T.start),new V(f,T.end||T.start);if(r instanceof S){for(x=0,O=r.tokens.length;x<O;x++)if(0===u.indexOf(r.tokens[x]))return s(c,T,T.start+r.tokens[x].length),new V(!0,T.end);return o.update(r,T.start),new V(!1,T.start)}return r instanceof k?(void 0===p._tested[T.start]?(p._tested[T.start]=t(p.element,T.start,T.children,p,!0),p._tree[T.start]=T.children):T.children=p._tree[T.start],p._tested[T.start].isValid&&s(c,T,p._tested[T.start].pos),p._tested[T.start]):void 0}(t,0,r,t,!0),c=e.substring(a.pos).replace(i,"");return a.isValid&&c&&(a.isValid=!1),!o.required.length&&c&&(o.setModeRequired(a.pos,!0),o.update(T,a.pos)),a.expecting=o.getExpecting(),a.isValid||(a.pos=o.pos),a};function h(){var t=P.call(this,h,arguments);if(t)return t;this.elements=this.checkElements(this.args)}function d(t,e){var r=P.call(this,d,arguments);if(r)return r;t=this.args[0],e=this.args[1],this.keyword=t,this.ignCase=Boolean(e)}h.prototype=Object.create(P.prototype),h.prototype.constructor=h,d.prototype=Object.create(P.prototype),d.prototype.constructor=d;var y=function t(e,r,o,s,i){var a=P.call(this,t,arguments);if(a)return a;if(e=this.args[0],r=void 0===this.args[1]?new J(","):this.args[1],o=this.args[2],s=this.args[3],i=this.args[4],!(e instanceof P))throw"(Jsleri--\x3eList) first argument must be an instance of Jsleri; got "+n(e);if("string"!=typeof r&&!(r instanceof P))throw"(Jsleri--\x3eList) second argument must be a string or instance of Jsleri; got "+n(r);this.element=e,this.delimiter=r instanceof P?r:new J(r),this.min=null==o?0:o,this.max=null==s?null:s,this.opt=Boolean(i)};function m(t){var e=P.call(this,m,arguments);if(e)return e;if(!((t=this.args[0])instanceof P))throw"(Jsleri--\x3eOptional) first argument must be an instance of Jsleri; got "+n(t);this.element=t}function g(){var t=P.call(this,g,arguments);return t||(this.elements=this.checkElements(this.args),new j(this))}function b(t,e){var r=P.call(this,b,arguments);if(r)return r;t=this.args[0],e=this.args[1],this.re=t,this._re=new RegExp("^"+t,e?"i":void 0)}function w(t,e,r){var o=P.call(this,w,arguments);if(o)return o;if(t=this.args[0],e=this.args[1],r=this.args[2],!(t instanceof P))throw"(Jsleri--\x3eRepeat) first argument must be an instance of Jsleri; got "+n(t);this.element=t,this.min=null==e?0:e,this.max=null==r?null:r}y.prototype=Object.create(P.prototype),y.prototype.constructor=y,m.prototype=Object.create(P.prototype),m.prototype.constructor=m,g.prototype=Object.create(P.prototype),g.prototype.constructor=g,b.prototype=Object.create(P.prototype),b.prototype.constructor=b,w.prototype=Object.create(P.prototype),w.prototype.constructor=w;var v=function(t){if(!(t instanceof P))throw"(Jsleri--\x3eRef--\x3eset) first argument must be an instance of Jsleri; got "+n(t);r(this,t)};function x(t){var e=function(){};e.prototype=t.prototype;var r=P.call(this,e,arguments);if(r)return r.set=v,r}function O(t,e){var r=P.call(this,O,arguments);if(r)return r;t=this.args[0],e=this.args[1];var o=null;if(void 0===t?(t=this.constructor.START,o=this.constructor):t.START&&(o=t,t=t.START),null!==o&&Object.getOwnPropertyNames(o).forEach((function(t){o[t]instanceof P&&(o[t].name=t)})),!(t instanceof P))throw"(Jsleri--\x3eOptional) first argument must be an instance of Jsleri; got "+n(t);this.reKeywords=void 0===e?a:l(e),this.element=t,this.parse=function(e){var r=new q(this,0,e.length,e),n=f(t,e,r.children,this.reKeywords);return n.tree=r,n}}function j(t){var e=P.call(this,j,arguments);if(e)return e;if(!((t=this.args[0])instanceof P))throw"(Jsleri--\x3eRule) first argument must be an instance of Jsleri; got "+n(t);this.element=t}function _(){var t=P.call(this,_,arguments);if(t)return t;this.elements=this.checkElements(this.args)}x.prototype=Object.create(P.prototype),x.prototype.constructor=x,O.prototype=Object.create(P.prototype),O.prototype.constructor=O,j.prototype=Object.create(P.prototype),j.prototype.constructor=j,_.prototype=Object.create(P.prototype),_.prototype.constructor=_;var k=function t(){if(!(this instanceof t))return new t};k.prototype=Object.create(P.prototype),k.prototype.constructor=k;var E=new k;function J(t){var e=P.call(this,J,arguments);if(e)return e;if("string"!=typeof(t=this.args[0]))throw"(Jsleri--\x3eToken) first argument must be a string; got "+n(t);this.token=t}function S(t){var e=P.call(this,S,arguments);if(e)return e;if("string"!=typeof(t=this.args[0]))throw"(Jsleri--\x3eTokens) first argument must be a string; got "+n(t);this.tokens=t.trim().split(c).sort(u)}function R(){this.e="End of statement"}J.prototype=Object.create(P.prototype),J.prototype.constructor=J,S.prototype=Object.create(P.prototype),S.prototype.constructor=S,R.prototype=Object.create(P.prototype),R.prototype.constructor=R;var T=new R;function V(t,e){this.isValid=t,this.pos=e,this.expecting=null}function q(t,e,r,n){this.element=t,this.start=e,this.end=r,this.str=n,this.children=[]}function C(){this.required=[],this.optional=[],this.pos=0,this._modes=[this.required]}function P(t,e){if(e=Array.prototype.slice.call(e),!(this instanceof t))return new(t.bind.apply(t,[t].concat(e)));this.setCallbacks(e),this.args=e}return q.prototype.walk=function(){this.element.onEnter(this);for(var t=0,e=this.children.length;t<e;t++)this.children[t].walk();this.element.onExit(this)},C.prototype.setModeRequired=function(t,e){this._modes[t]!==this.optional&&(this._modes[t]=!1===e?this.optional:this.required)},C.prototype.empty=function(){this.required.length=0,this.optional.length=0},C.prototype.update=function(t,e){e>this.pos&&(this.empty(),this.pos=e),e===this.pos&&-1===this._modes[e].indexOf(t)&&this._modes[e].push(t)},C.prototype.getExpecting=function(){return this.required.concat(this.optional)},P.prototype.setCallbacks=function(t){var e=t[0];null==e||"string"==typeof e||e instanceof P||void 0!==e.START||(p(e.onEnter)&&(this.onEnter=e.onEnter),p(e.onExit)&&(this.onExit=e.onExit),t.splice(0,1))},P.prototype.onEnter=s,P.prototype.onExit=s,P.prototype.checkElements=function(t){var e=0,r=t.length;if(0===r)throw"(Jsleri--\x3e"+this.constructor.name+") Need at least one Jsleri argument";for(;e<r;e++)t[e]instanceof P||(t[e]=new J(t[e]));return t},P.prototype.checkElement=function(t){return t instanceof P||(t=new J(t)),t},e})()}));